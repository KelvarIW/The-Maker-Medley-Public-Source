<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprFinalPatToaster</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>objAvoPar</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Call parent event
event_inherited();

//Overwrite parent defaults
startTime = 60;
endTime = 836;
createIdent = false;
bgmSource = global.BGMBoss4Avo2;

usePracticeSystem = false; //this is part of a larger fight

//Specific
rise = 0;
autosave = false;

yspeed = 0;
yvel = 0;
yaccel = 0.1;
switchytime = 30;
ycount = switchytime / 2;

backGlow = 0;
backGlowAng = -pi/2;
backScaleMult = 0;

image_speed = 0;

if (global.practicing){
    if (global.practiceWaypointStart == 4){
        timer = 418 - 0.5;
        startTime = timer;
        
        with (instance_create(view_xview, view_yview, objScreenFade)){
            alpha = 1;
            fade = 1;
            color = c_black;
            fadeOut = 1/30;
        }
        nametag = scrFinalBossNametag(x, y-84, 5);
    }else if (global.practiceWaypointEnd == 4){
        endTime = 418;
    }
    
    with (objFinalYoyo){
        nametag = scrFinalBossNametag(x, y-24, 6);
        image_blend = c_white;
        visible = true; //needed if we're starting from the third checkpoint
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

backGlowAng += pi/40;
backGlow = (sin(backGlowAng)/2 + 0.5);
if (backScaleMult &lt; 1){
    backScaleMult = min(backScaleMult+0.025, 1);
}

//cool hovering code by patrickgh3
if (timer &gt;= 60){
    y += yvel;
    yvel += yaccel;
    ycount += 1;
    if (ycount == switchytime)
    {
        yaccel *= -1;
        ycount = 0;
    }
}

image_index = (global.count / 5);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="objPlayer">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (timer &gt;= 60){
    scrKillPlayer();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Attacks
switch(timerEvent){
    case 50:
        if (!instance_exists(objFinalRNGDie) &amp;&amp; instance_exists(objFinalYoyo)){
            instance_create(objFinalYoyo.x, objFinalYoyo.y, objFinalRNGDie);
        }
        with (objFinalRNGDie){
            if (targetObj != objFinalYoyo){
                targetObj = objFinalYoyo;
                event_user(0);
                if (instance_exists(objFinalYoyo) &amp;&amp; point_distance(x, y, objFinalYoyo.x, objFinalYoyo.y) &lt; 1){
                    latchedOn = true;
                }
            }
            shrink = false;
            grow = true;
        }
        with (instance_create(view_xview, view_yview, objScreenFade)){
            alpha = 1;
            fade = 0;
            color = c_black;
            fadeOut = 1/60;
        }
        scrFinalUpdateFarthest();
        break;
    case 60:
        with (objScreenFade){
            fade = 1;
        }
        with (objFinalBossHP){
            yPosLerp = 0;
        }
        with (objFinalRNGDie){
            grow = true;
            shrink = false;
        }
        nametag = scrFinalBossNametag(x, y-84, 5);
        with (objFinalYoyo){
            nametag = scrFinalBossNametag(x, y - 24, 6);
            
            image_blend = c_white;
            visible = true;  // starting from save point
        }
        createIdent = true;
        global.finalBossHP[2] = global.finalBossHP[1];
        if (autosave &amp;&amp; !global.practicing){
            scrTMM_Autosave(((room_width-800)+400), 535, 3);
        }
        
        if (buff()){
            with (objFinalPatArena){
                y = ystart + 96;  // failsafe
                buffTimer = 0;
            }
        }
        break;
    case 341.5:
        with (objFinalYoyoFruitBounce){
            blackFade = true;
            if (friction == 0)
                friction = speed/70;
            //indexBase = -1;
        }
    case 248.5:
    case 271.5:
    case 295.5:
    case 318:
        var _proj, _count, _spawnX;
        _count = (timerEvent - 248.5) div 22;
        switch(_count){
            case 0:
                _spawnX = -20;
                break;
            case 1:
                _spawnX = 400;
                break;
            case 2:
                _spawnX = 820;
                break;
            case 3:
                _spawnX = 200;
                break;
            case 4:
                _spawnX = 600;
                break;
        }
        
        var _num;  // per quarter circle
        if (buff()){
            _num = 5;
        }else{
            _num = 3;
        }
        
        var _angInc;
        _angInc = 90/(_num+1);
        
        if (_spawnX &lt; 800){
            for(var i=1;i&lt;=_num;i++){
                _proj = instance_create(view_xview + _spawnX, -20, objFinalPatTear);
                if (_spawnX &gt;= 0 &amp;&amp; _spawnX &lt;= 800){
                    _proj.sprite_index = sprMakerTHRounded;
                    _proj.indexBase = _count*4;
                }else{
                    _proj.sprite_index = sprMakerTHPointed;
                    _proj.indexBase = _count*5;
                }
                _proj.speed = 2.25;
                _proj.direction = 270 + i*_angInc;
            }
        }
        if (_spawnX &gt; 0){
            for(var i=0;i&lt;=_num;i++){  // also includes straight down
                _proj = instance_create(view_xview + _spawnX, -20, objFinalPatTear);
                if (_spawnX &gt;= 0 &amp;&amp; _spawnX &lt;= 800){
                    _proj.sprite_index = sprMakerTHRounded;
                    _proj.indexBase = _count*4;
                }else{
                    _proj.sprite_index = sprMakerTHPointed;
                    _proj.indexBase = _count*5;
                }
                _proj.speed = 2.25;
                _proj.direction = 270 - i*_angInc;
            }
        }
        break;
    case 383:
        with (objFinalYoyoFruitBounce){
            var _inst;
            _inst = instance_create(x, y, objFinalYoyoFruit);
            _inst.image_index = (floor(image_index) mod 2) + 18;
            _inst.index = 0;
            _inst.indexBase = -1;
            with (_inst)
                event_user(0);
            instance_destroy();
        }
        break;
    case 418:  // Practice Waypoint
        if (!global.practicing){
            scrFinalUpdateFarthest();
        }else if (global.practicing &amp;&amp; global.practiceWaypointEnd == 4){
            scrPracticeEnd();
        }
        break;
    case 438:
        instance_create(view_xview + 38 + 362, -292 + 468, objFinalPatTearfruit);

        instance_create(view_xview + 38 + 344, -257 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 380, -257 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 327, -224 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 397, -224 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 310, -191 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 414, -191 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 296, -159 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 428, -159 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 290, -125 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 434, -125 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 299, -92 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 425, -92 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 325, -73 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 399, -73 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 362, -60 + 468, objFinalPatTearfruit);
        
        with (objFinalPatTearfruit){
            spawnerIndex = 1;
        }
        
        instance_create(view_xview + 38 + 362, -217 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 352, -194 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 372, -194 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 339, -174 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 385, -174 + 468, objFinalPatTearfruit);
        //center: 362, -164
        instance_create(view_xview + 38 + 333, -154 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 391, -154 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 337, -132 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 387, -132 + 468, objFinalPatTearfruit);
        
        instance_create(view_xview + 38 + 352, -111 + 468, objFinalPatTearfruit);
        instance_create(view_xview + 38 + 372, -111 + 468, objFinalPatTearfruit);
        
        with (objFinalPatTearfruit){
            spawner = true;
            event_user(0);
        }
        break;
    case 446:
    case 470:
    case 494:
    case 516:
    case 540:
    case 564:
    case 588:
    case 610:
        with (objFinalYoyo){
            scrMakeShapes(x,y,random(360),4,4,choose(6,7,8),objFinalYoyoFruit);
        }
        
        with (objFinalYoyoFruit){
            if (!init){
                event_user(0);
            }
        }
        
        
        with (objFinalPatTearfruit){
            if (spawner){ //don't affect any existing PROJECTILE fruit
                event_user(1);
            }
        }
        break;
    case 458:
    case 482:
    case 506:
    case 528:
    case 552:
    case 576:
    case 599:
        if (!buff()){
            with (objFinalYoyo){
                scrMakeShapes(x,y,random(360),3,5,choose(6, 6, 7, 7, 7,8),objFinalYoyoFruit);
            }
        }else{
            with (objFinalYoyo){
                scrMakeShapes(x,y,random(360),3,choose(5, 5, 6),choose(6, 7, 8, 8.5),objFinalYoyoFruit);
            }
        }
        
        with (objFinalYoyoFruit){
            if (!init){
                event_user(0);
            }
        }
        break;
    case 622:
        with (objFinalPatTearfruit){ //don't change any existing PROJECTILE fruit
            if (spawner)
                blueAlpha = 0;
        }
        if (!buff()){  // buffed mode has one more RNG attack
            with (objFinalRNGDie){ //held by YoYoYoDude
                shrink = true;
                grow = false;
            }
        }
    case 645:
    case 670:
    case 693:
    case 717:
    case 740:
    case 763:
    case 787:
        with (objFinalPatTearfruit){
            if (spawner &amp;&amp; spawnerIndex == 0)
                event_user(1);
        }
        break;
    case 634:
    case 658:
    case 681:
    case 704:
    case 728:
    case 751:
    case 773:
        with (objFinalPatTearfruit){
            if (spawner)
                event_user(1);
        }
        break;
    case 680:
        if (buff()){ // didn't lower die yet
            with (objFinalRNGDie){
                shrink = true;
                grow = false;
            }
        }
    break;
    case 803:
        if (global.practicing &amp;&amp; global.practiceWaypointEnd == 5){
            scrPracticeEnd();
        }
        break;
    case 836:
        if (!global.dead &amp;&amp; instance_exists(objPlayer)){
            with (objPlayer){
                with (instance_create(x, y, objFakePlayer)){
                    image_index = other.image_index;
                    image_speed = 0;
                    sprite_index = other.sprite_index;
                    image_xscale = other.xScale;
                    alphaInc = -1;
                }
                instance_create(x, y-16, objFinalP2Exclamation);
                audio_play_sound(sndMakerExclamation, 0, 0);
                instance_destroy();
            }
            with (objMakerCirclePart){
                radDec = 0;
                speed = 0;
                gravity = 0;
                fade = 0;
            }
            with (objBullet){
                alarm[0] = -1;
                speed = 0;
                image_speed = 0;
            }
            with (objBulletReflected){
                speed = 0;
                gravity = 0;
                alphaChange = 0;
            }
        }
        break;
    case 861:
        with (objFakePlayer){
            instance_create(x, y, objFinalP3UndertaleTransition);
        }
        break;
}
if (!global.dead &amp;&amp; timerEvent == 773){
    with (objFinalPatTearfruit){
        if (spawner){
            fadeout = true;
        }
    }
}
//inequalities
if (timerEvent &gt;= 60 &amp;&amp; timerEvent &lt; 341 &amp;&amp; timerEvent mod 6 == 0){
    with (objFinalYoyo){
        instance_create(x, y - 8, objFinalYoyoFruitBounce);
    }
}
if (buff()){
    if (timerEvent &gt;= 622 &amp;&amp; timerEvent &lt;= 673 &amp;&amp; timerEvent mod 2 == 0){
        with (objFinalYoyo){
            var _inst;
            _inst = instance_create(x, y - 8, objFinalYoyoFruit);
            _inst.direction = random_range(170,280);
            _inst.speed = random_range(8,10);
            _inst.index = 3;
            with (_inst){
                event_user(0);
            }
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (timer &gt;= 60){
    draw_self();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
